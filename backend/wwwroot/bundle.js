var app=function(){"use strict";function e(){}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e){return e()}function r(){return Object.create(null)}function o(e){e.forEach(n)}function i(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t,n){e.$$.on_destroy.push(t.subscribe(n))}function a(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n)}function l(e){e.parentNode.removeChild(e)}function h(e,t){for(var n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function p(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function g(){return document.createComment("")}function d(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function m(e,t){e.data=""+t}function v(e,t,n){e.style.setProperty(t,n)}function b(e,t,n){e.classList[n?"add":"remove"](t)}let y,w;function S(){y={remaining:0,callbacks:[]}}function x(){y.remaining||o(y.callbacks)}function k(e){y.callbacks.push(e)}function T(e){w=e}let C,P=[];const $=[],E=[];function I(e){E.push(e)}function _(e){$.push(e)}function O(){const e=new Set;do{for(;P.length;){const e=P.shift();T(e),R(e.$$)}for(;$.length;)$.shift()();for(;E.length;){const t=E.pop();e.has(t)||(t(),e.add(t))}}while(P.length);C=null}function R(e){e.fragment&&(e.update(e.dirty),o(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(I))}function N(e,n){var r,o=n.token={};function i(e,r,i,s){if(n.token!==o)return;n.resolved=i&&{[i]:s};const c=t(t({},n.ctx),n.resolved),a=e&&(n.current=e)(c);n.block&&(n.blocks?n.blocks.forEach((e,t)=>{t!==r&&e&&(S(),k(()=>{e.d(1),n.blocks[t]=null}),e.o(1),x())}):n.block.d(1),a.c(),a.i&&a.i(1),a.m(n.mount(),n.anchor),O()),n.block=a,n.blocks&&(n.blocks[r]=a)}if((r=e)&&"function"==typeof r.then){if(e.then(e=>{i(n.then,1,n.value,e)},e=>{i(n.catch,2,n.error,e)}),n.current!==n.pending)return i(n.pending,0),!0}else{if(n.current!==n.then)return i(n.then,1,n.value,e),!0;n.resolved={[n.value]:e}}}function W(e,t,r){const{fragment:s,on_mount:c,on_destroy:a,after_render:u}=e.$$;s.m(t,r),I(()=>{const t=c.map(n).filter(i);a?a.push(...t):o(t),e.$$.on_mount=[]}),u.forEach(I)}function j(e,t){e.$$.dirty||(P.push(e),C||(C=Promise.resolve()).then(O),e.$$.dirty={}),e.$$.dirty[t]=!0}function M(t,n,i,s,c){const a=w;T(t);const u=n.props||{},l=t.$$={fragment:null,ctx:null,update:e,not_equal:c,bound:r(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(a?a.$$.context:[]),callbacks:r(),dirty:null};let h=!1;var p;l.ctx=i?i(t,u,(e,n)=>{if(l.bound[e]&&l.bound[e](n),l.ctx){const r=c(n,l.ctx[e]);return h&&r&&j(t,e),l.ctx[e]=n,r}}):u,l.update(),h=!0,o(l.before_render),l.fragment=s(l.ctx),n.target&&(n.hydrate?l.fragment.l((p=n.target,Array.from(p.childNodes))):l.fragment.c(),n.intro&&t.$$.fragment.i&&t.$$.fragment.i(),W(t,n.target,n.anchor),O()),T(a)}class H{$destroy(){var t,n;n=!0,(t=this).$$&&(o(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function q(e){var t,n,r,o,i,s,c,h,g,d,v,b,y,w,S,x,k,T,C,P,$,E,I,_,O,R,N,W,j,M,H,q,A,L,U=e.textToWrite.slice(e.matchingPrefix.length),F=e.writtenText.slice(e.matchingPrefix.length);return{c(){t=p("div"),n=f("WrittenText: "),r=p("span"),o=f('"'),i=f(e.writtenText),s=f('"'),c=f("\n"),h=p("div"),g=f("Matching Prefix: "),d=p("span"),v=f('"'),b=f(e.matchingPrefix),y=f('"'),w=f("\n"),S=p("div"),x=f("Rest: "),k=p("span"),T=f('"'),C=f(U),P=f('"'),$=f("\n"),E=p("div"),I=f("Wrong letters: "),_=p("span"),O=f('"'),R=f(F),N=f('"'),W=f("\n"),j=p("div"),M=f("no errors: "),H=p("span"),q=f('"'),A=f(e.numberOfErrors),L=f('"'),r.className="svelte-m8oud8",d.className="svelte-m8oud8",k.className="svelte-m8oud8",_.className="svelte-m8oud8",H.className="svelte-m8oud8"},m(e,l){u(e,t,l),a(t,n),a(t,r),a(r,o),a(r,i),a(r,s),u(e,c,l),u(e,h,l),a(h,g),a(h,d),a(d,v),a(d,b),a(d,y),u(e,w,l),u(e,S,l),a(S,x),a(S,k),a(k,T),a(k,C),a(k,P),u(e,$,l),u(e,E,l),a(E,I),a(E,_),a(_,O),a(_,R),a(_,N),u(e,W,l),u(e,j,l),a(j,M),a(j,H),a(H,q),a(H,A),a(H,L)},p(e,t){e.writtenText&&m(i,t.writtenText),e.matchingPrefix&&m(b,t.matchingPrefix),(e.textToWrite||e.matchingPrefix)&&U!==(U=t.textToWrite.slice(t.matchingPrefix.length))&&m(C,U),(e.writtenText||e.matchingPrefix)&&F!==(F=t.writtenText.slice(t.matchingPrefix.length))&&m(R,F),e.numberOfErrors&&m(A,t.numberOfErrors)},d(e){e&&(l(t),l(c),l(h),l(w),l(S),l($),l(E),l(W),l(j))}}}function A(t){var n,r,o,i,s,c,h,d,v,b=t.debug&&q(t);return{c(){n=p("div"),r=p("span"),o=f(t.matchingPrefix),i=p("span"),s=f(t.errorPart),c=p("span"),h=f(t.remainingPart),d=f("\n"),b&&b.c(),v=g(),r.className="correct svelte-m8oud8",i.className="incorrect svelte-m8oud8",c.className="svelte-m8oud8"},m(e,t){u(e,n,t),a(n,r),a(r,o),a(n,i),a(i,s),a(n,c),a(c,h),u(e,d,t),b&&b.m(e,t),u(e,v,t)},p(e,t){e.matchingPrefix&&m(o,t.matchingPrefix),e.errorPart&&m(s,t.errorPart),e.remainingPart&&m(h,t.remainingPart),t.debug?b?b.p(e,t):((b=q(t)).c(),b.m(v.parentNode,v)):b&&(b.d(1),b=null)},i:e,o:e,d(e){e&&(l(n),l(d)),b&&b.d(e),e&&l(v)}}}function L(e,t,n){let r,o,i,s,{textToWrite:c="Populate the textToWrite prop to insert your own text to write!",writtenText:a="",debug:u=!1}=t;return e.$set=(e=>{"textToWrite"in e&&n("textToWrite",c=e.textToWrite),"writtenText"in e&&n("writtenText",a=e.writtenText),"debug"in e&&n("debug",u=e.debug)}),e.$$.update=((e={writtenText:1,textToWrite:1,matchingPrefix:1,numberOfErrors:1})=>{(e.writtenText||e.textToWrite)&&(r=function(e,t){for(let n=e.length;n>0;n--){let r=e.slice(0,n);if(r===t.slice(0,n))return r}return""}(a,c),n("matchingPrefix",r)),(e.writtenText||e.matchingPrefix)&&(o=a.length-r.length,n("numberOfErrors",o)),(e.textToWrite||e.matchingPrefix||e.numberOfErrors)&&(i=c.slice(r.length,r.length+o),n("errorPart",i)),(e.textToWrite||e.matchingPrefix||e.numberOfErrors)&&(s=c.slice(r.length+o),n("remainingPart",s))}),{textToWrite:c,writtenText:a,debug:u,matchingPrefix:r,numberOfErrors:o,errorPart:i,remainingPart:s}}class U extends H{constructor(e){super(),M(this,e,L,A,s)}get textToWrite(){return this.$$.ctx.textToWrite}set textToWrite(e){this.$set({textToWrite:e}),O()}get writtenText(){return this.$$.ctx.writtenText}set writtenText(e){this.$set({writtenText:e}),O()}get debug(){return this.$$.ctx.debug}set debug(e){this.$set({debug:e}),O()}}function F(e){var t,n,r,i,s,c,h,g,m,v,b=new U({props:{textToWrite:e.currentProblem,writtenText:e.writtenText}}),y=""===e.remainingText&&G(e),w=K;return{c(){var o,a,u;b.$$.fragment.c(),t=f("\n\t"),n=p("br"),r=f("\n\t"),i=p("input"),c=f("\n\t"),h=p("div"),y&&y.c(),g=f("\n\t\t"),w&&w.c(),i.autofocus=!0,o=i,a="type",null==(u="text")?o.removeAttribute(a):o.setAttribute(a,u),i.placeholder=s=""===e.confirmedText?`${e.currentProblem.slice(0,10)}...`:"",i.className="svelte-12unudd",v=[d(i,"input",e.input_input_handler),d(i,"input",e.handleInput),d(i,"keyup",e.handleKeyUp)]},m(o,s){W(b,o,s),u(o,t,s),u(o,n,s),u(o,r,s),u(o,i,s),i.value=e.pendingText,u(o,c,s),u(o,h,s),y&&y.m(h,null),a(h,g),w&&w.m(h,null),m=!0,i.focus()},p(e,t){var n={};e.currentProblem&&(n.textToWrite=t.currentProblem),e.writtenText&&(n.writtenText=t.writtenText),b.$set(n),e.pendingText&&(i.value=t.pendingText),m&&!e.confirmedText&&!e.currentProblem||s===(s=""===t.confirmedText?`${t.currentProblem.slice(0,10)}...`:"")||(i.placeholder=s),""===t.remainingText?y||((y=G(t)).c(),y.m(h,g)):y&&(y.d(1),y=null),w&&(w.d(1),w=null)},i(e){m||(b.$$.fragment.i(e),m=!0)},o(e){b.$$.fragment.o(e),m=!1},d(e){b.$destroy(e),e&&(l(t),l(n),l(r),l(i),l(c),l(h)),y&&y.d(),w&&w.d(),o(v)}}}function D(t){var n;return{c(){(n=p("strong")).textContent="Congratulations, you finished the problem set!"},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&l(n)}}}function G(e){var t;return{c(){(t=p("div")).textContent="Complete! Hit Return ↵ for another challenge!",t.className="complete svelte-12unudd"},m(e,n){u(e,t,n)},d(e){e&&l(t)}}}function B(e){var t,n,r,o,i=[D,F],s=[];function c(e){return e.setCompleted?0:1}return t=c(e),n=s[t]=i[t](e),{c(){n.c(),r=g()},m(e,n){s[t].m(e,n),u(e,r,n),o=!0},p(e,o){var a=t;(t=c(o))===a?s[t].p(e,o):(S(),k(()=>{s[a].d(1),s[a]=null}),n.o(1),x(),(n=s[t])||(n=s[t]=i[t](o)).c(),n.i(1),n.m(r.parentNode,r))},i(e){o||(n&&n.i(),o=!0)},o(e){n&&n.o(),o=!1},d(e){s[t].d(e),e&&l(r)}}}let K=!1;function J(e,t,n){let r,o,{problemSet:i={name:"Example set",problems:["Example text to write!"]},onprogress:s=(()=>{})}=t,{setProblemIndex:c=function(e){n("currentProblemIndex",a=e)}}=t,a=0,u=i.problems[a],l=u,h="",p="";return e.$set=(e=>{"problemSet"in e&&n("problemSet",i=e.problemSet),"onprogress"in e&&n("onprogress",s=e.onprogress),"setProblemIndex"in e&&n("setProblemIndex",c=e.setProblemIndex)}),e.$$.update=((e={problemSet:1,currentProblemIndex:1,currentProblem:1,confirmedText:1,pendingText:1,remainingText:1})=>{(e.problemSet||e.currentProblemIndex||e.currentProblem)&&(u=i.problems[a],n("currentProblem",u),n("remainingText",l=u),n("confirmedText",h=""),n("pendingText",p="")),(e.confirmedText||e.pendingText)&&n("writtenText",r=`${h}${p}`),(e.currentProblemIndex||e.problemSet||e.remainingText)&&(o=a===i.problems.length-1&&""===l,n("setCompleted",o))}),{problemSet:i,onprogress:s,setProblemIndex:c,currentProblem:u,remainingText:l,confirmedText:h,pendingText:p,handleInput:function(e){const t=p===l;(" "===e.data||t)&&(t||p===l.substring(0,p.length))&&(l=l.slice(p.length),n("remainingText",l),n("confirmedText",h=`${h}${p}`),n("pendingText",p=""),s(h.length/u.length))},handleKeyUp:function(e){"Enter"===e.code&&""===l&&(console.log(o,a,i.problems.length-1),o||n("currentProblemIndex",a+=1))},writtenText:r,setCompleted:o,input_input_handler:function(){p=this.value,n("pendingText",p)}}}class X extends H{constructor(e){super(),M(this,e,J,B,s)}get problemSet(){return this.$$.ctx.problemSet}set problemSet(e){this.$set({problemSet:e}),O()}get onprogress(){return this.$$.ctx.onprogress}set onprogress(e){this.$set({onprogress:e}),O()}get setProblemIndex(){return this.$$.ctx.setProblemIndex}set setProblemIndex(e){this.$set({setProblemIndex:e}),O()}}function z(e,t,n){const r=Object.create(e);return r.problemSet=t[n],r.i=n,r}function Y(e){var t,n,r,o=e.problemSet.name;function i(...t){return e.click_handler(e,...t)}return{c(){t=p("a"),n=f(o),t.href="#"+e.problemSet.name,t.className="svelte-1b1yjc9",r=d(t,"click",i)},m(e,r){u(e,t,r),a(t,n)},p(t,n){e=n},d(e){e&&l(t),r()}}}function V(e){for(var t,n,r,o,i,s,c,g,d,m,v=e.problemSets,b=[],y=0;y<v.length;y+=1)b[y]=Y(z(e,v,y));let w={problemSet:e.currentProblemSet};var S=new X({props:w});return _(()=>e.practicepad_binding(S)),{c(){t=p("div"),(n=p("h2")).textContent="Welcome to TypeDojo",r=f("\n\t"),o=p("div");for(var e=0;e<b.length;e+=1)b[e].c();i=f("\n\t"),(s=p("div")).textContent="Type the text below into the text field.",c=f("\n\t"),g=p("hr"),d=f("\n\t"),S.$$.fragment.c(),t.className="main svelte-1b1yjc9"},m(e,l){u(e,t,l),a(t,n),a(t,r),a(t,o);for(var h=0;h<b.length;h+=1)b[h].m(o,null);a(t,i),a(t,s),a(t,c),a(t,g),a(t,d),W(S,t,null),m=!0},p(e,t){if(e.problemSets){v=t.problemSets;for(var n=0;n<v.length;n+=1){const r=z(t,v,n);b[n]?b[n].p(e,r):(b[n]=Y(r),b[n].c(),b[n].m(o,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=v.length}var r={};e.currentProblemSet&&(r.problemSet=t.currentProblemSet),S.$set(r)},i(e){m||(S.$$.fragment.i(e),m=!0)},o(e){S.$$.fragment.o(e),m=!1},d(n){n&&l(t),h(b,n),e.practicepad_binding(null),S.$destroy()}}}function Q(e,t,n){const r=[{name:"Text",problems:["What a wonderful world!","What is this, magic?"]},{name:"Code",problems:["function(x) { return x; }",'() => { return "Hello, world!"; }']},{name:"Numbers & Symbols",problems:["1820 3949 0695 8231","%*@! <(}! >?|) *@)# []&* =~-\\ /.${"]}];let o,i=r[0];function s(e,t){o.setProblemIndex(0),i=r[t],n("currentProblemSet",i),e.preventDefault()}return{problemSets:r,currentProblemSet:i,practicePad:o,handleClick:s,click_handler:function({i:e},t){return s(t,e)},practicepad_binding:function(e){n("practicePad",o=e)}}}class Z extends H{constructor(e){super(),M(this,e,Q,V,s)}}function ee(t){var n,r;return{c(){n=p("div"),(r=p("span")).className="completed svelte-wc8jqk",v(r,"width",Math.floor(100*t.progress)+"%"),n.className="svelte-wc8jqk"},m(e,t){u(e,n,t),a(n,r)},p(e,t){e.progress&&v(r,"width",Math.floor(100*t.progress)+"%")},i:e,o:e,d(e){e&&l(n)}}}function te(e,t,n){let{progress:r=0}=t;return e.$set=(e=>{"progress"in e&&n("progress",r=e.progress)}),{progress:r}}class ne extends H{constructor(e){super(),M(this,e,te,ee,s)}get progress(){return this.$$.ctx.progress}set progress(e){this.$set({progress:e}),O()}}function re(t,n=e){let r;const o=[];function i(e){if(s(t,e)){if(t=e,!r)return;o.forEach(e=>e[1]()),o.forEach(e=>e[0](t))}}return{set:i,update:function(e){i(e(t))},subscribe:function(i,s=e){const c=[i,s];return o.push(c),1===o.length&&(r=n()||e),i(t),()=>{const e=o.indexOf(c);-1!==e&&o.splice(e,1),0===o.length&&r()}}}}const oe=re({}),ie=re({});function se(e){var t,n,r,o,i,s,c=e.$nameService[e.user.id]?e.$nameService[e.user.id]:e.user.id,h=ce((100*e.user.progress).toFixed(1),5),g=new ne({props:{progress:e.user.progress}});return{c(){t=p("div"),n=f(c),r=f(" "),o=f(h),i=f("%\r\n    "),g.$$.fragment.c(),t.className="svelte-11x4rlf",b(t,"me",e.isme)},m(e,c){u(e,t,c),a(t,n),a(t,r),a(t,o),a(t,i),W(g,t,null),s=!0},p(e,r){s&&!e.$nameService&&!e.user||c===(c=r.$nameService[r.user.id]?r.$nameService[r.user.id]:r.user.id)||m(n,c),s&&!e.user||h===(h=ce((100*r.user.progress).toFixed(1),5))||m(o,h);var i={};e.user&&(i.progress=r.user.progress),g.$set(i),e.isme&&b(t,"me",r.isme)},i(e){s||(g.$$.fragment.i(e),s=!0)},o(e){g.$$.fragment.o(e),s=!1},d(e){e&&l(t),g.$destroy()}}}function ce(e,t){return(e.length<t?Array(t-e.length).join(" "):"")+e}function ae(e,t,n){let r;c(e,ie,e=>{n("$nameService",r=e)});let{user:o={},isme:i=!1}=t;return e.$set=(e=>{"user"in e&&n("user",o=e.user),"isme"in e&&n("isme",i=e.isme)}),{user:o,isme:i,$nameService:r}}class ue extends H{constructor(e){super(),M(this,e,ae,se,s)}get user(){return this.$$.ctx.user}set user(e){this.$set({user:e}),O()}get isme(){return this.$$.ctx.isme}set isme(e){this.$set({isme:e}),O()}}function le(e,t,n){const r=Object.create(e);return r.userKey=t[n],r}function he(t){var n,r,o,i=t.error.message;return{c(){n=p("p"),r=f("Error joining racing group "),o=f(i),v(n,"color","red")},m(e,t){u(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&l(n)}}}function pe(e){var t,n,r,o,i;let s={onprogress:e.progressHandler,problemSet:e.currentProblemSet};var c=new X({props:s});return _(()=>e.practicepad_binding(c)),{c(){(t=p("div")).textContent="Type the text below into the text field.",n=f("\n\t\t"),r=p("hr"),o=f("\n\t\t"),c.$$.fragment.c()},m(e,s){u(e,t,s),u(e,n,s),u(e,r,s),u(e,o,s),W(c,e,s),i=!0},p(e,t){var n={};e.progressHandler&&(n.onprogress=t.progressHandler),e.currentProblemSet&&(n.problemSet=t.currentProblemSet),c.$set(n)},i(e){i||(c.$$.fragment.i(e),i=!0)},o(e){c.$$.fragment.o(e),i=!1},d(i){i&&(l(t),l(n),l(r),l(o)),e.practicepad_binding(null),c.$destroy(i)}}}function fe(t){var n;return{c(){(n=p("p")).textContent="...connecting to racing group"},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&l(n)}}}function ge(e){var t,n=new ue({props:{isme:e.userKey===e.myId,user:e.$currentUsers[e.userKey]}});return{c(){n.$$.fragment.c()},m(e,r){W(n,e,r),t=!0},p(e,t){var r={};(e.$currentUsers||e.myId)&&(r.isme=t.userKey===t.myId),e.$currentUsers&&(r.user=t.$currentUsers[t.userKey]),n.$set(r)},i(e){t||(n.$$.fragment.i(e),t=!0)},o(e){n.$$.fragment.o(e),t=!1},d(e){n.$destroy(e)}}}function de(e){var n,r,o,i,s,c,g,d,m,v;let b={ctx:e,current:null,pending:fe,then:pe,catch:he,value:"joined",error:"error",blocks:Array(3)};N(i=e.joinRaceGroup,b);for(var y=Object.keys(e.$currentUsers),w=[],T=0;T<y.length;T+=1)w[T]=ge(le(e,y,T));function C(e,t,n){w[e]&&(t&&k(()=>{w[e].d(t),w[e]=null}),w[e].o(n))}return{c(){n=p("div"),(r=p("h2")).textContent="🏍️ Welcome to Racing in TypeDojo",o=f("\n\n\t"),b.block.c(),s=f("\n\n\t"),c=p("hr"),g=f("\n\t"),d=p("div"),m=f("Connected users:\n\t\t");for(var e=0;e<w.length;e+=1)w[e].c();n.className="main svelte-tctpn1"},m(e,t){u(e,n,t),a(n,r),a(n,o),b.block.m(n,b.anchor=null),b.mount=(()=>n),b.anchor=s,a(n,s),a(n,c),a(n,g),a(n,d),a(d,m);for(var i=0;i<w.length;i+=1)w[i].m(d,null);v=!0},p(n,r){if(e=r,b.ctx=e,i!==(i=e.joinRaceGroup)&&N(i,b)||b.block.p(n,t(t({},e),b.resolved)),n.$currentUsers||n.myId){y=Object.keys(e.$currentUsers);for(var o=0;o<y.length;o+=1){const t=le(e,y,o);w[o]?(w[o].p(n,t),w[o].i(1)):(w[o]=ge(t),w[o].c(),w[o].i(1),w[o].m(d,null))}for(S();o<w.length;o+=1)C(o,1,1);x()}},i(e){if(!v){b.block.i();for(var t=0;t<y.length;t+=1)w[t].i();v=!0}},o(e){for(let e=0;e<3;e+=1){const t=b.blocks[e];t&&t.o()}w=w.filter(Boolean);for(let e=0;e<w.length;e+=1)C(e,0);v=!1},d(e){e&&l(n),b.block.d(),b=null,h(w,e)}}}function me(e,t,n){let r,o;c(e,ie,e=>{n("$nameService",r=e)}),c(e,oe,e=>{n("$currentUsers",o=e)});let{racingGroup:i="defaultRaceGroup",signalrConnection:s,myId:a=""}=t;let u,l=[{name:"Text",problems:["What a wonderful world! A world where you can type and type as you wonder: What does it all mean? Let the letters flow through your fingertips, your fingers like little spiders on the keyboard.","What is this, magic? That is the question everyone is asking themselves, is it really magic or is it just a little bit of good luck and some SignalR?"]},{name:"Code",problems:["function(x) { return x; }",'() => { return "Hello, world!"; }']},{name:"Numbers & Symbols",problems:["1820 3949 0695 8231","%*@! <(}! >?|) *@)# []&* =~-\\ /.${"]}][0];const h=s().then(e=>e.invoke("joinGroup",i,r[a]?r[a]:""));return e.$set=(e=>{"racingGroup"in e&&n("racingGroup",i=e.racingGroup),"signalrConnection"in e&&n("signalrConnection",s=e.signalrConnection),"myId"in e&&n("myId",a=e.myId)}),{racingGroup:i,signalrConnection:s,myId:a,currentProblemSet:l,practicePad:u,joinRaceGroup:h,progressHandler:function(e){s().then(t=>t.invoke("Progress",i,e))},$currentUsers:o,practicepad_binding:function(e){n("practicePad",u=e)}}}class ve extends H{constructor(e){super(),M(this,e,me,de,s)}get racingGroup(){return this.$$.ctx.racingGroup}set racingGroup(e){this.$set({racingGroup:e}),O()}get signalrConnection(){return this.$$.ctx.signalrConnection}set signalrConnection(e){this.$set({signalrConnection:e}),O()}get myId(){return this.$$.ctx.myId}set myId(e){this.$set({myId:e}),O()}}var be,ye,we=(be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}be(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Se=function(e){function t(t,n){var r=this,o=this.constructor.prototype;return(r=e.call(this,t)||this).statusCode=n,r.__proto__=o,r}return we(t,e),t}(Error),xe=function(e){function t(t){void 0===t&&(t="A timeout occurred.");var n=this,r=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=r,n}return we(t,e),t}(Error),ke=function(e){function t(t){void 0===t&&(t="An abort occurred.");var n=this,r=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=r,n}return we(t,e),t}(Error),Te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ce=function(){return function(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}(),Pe=function(){function e(){}return e.prototype.get=function(e,t){return this.send(Te({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(Te({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(Te({},t,{method:"DELETE",url:e}))},e.prototype.getCookieString=function(e){return""},e}();!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(ye||(ye={}));var $e,Ee=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(e){function t(t){var n=e.call(this)||this;return n.logger=t,n}return Ee(t,e),t.prototype.send=function(e){var t=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ke):e.method?e.url?new Promise(function(n,r){var o=new XMLHttpRequest;o.open(e.method,e.url,!0),o.withCredentials=!0,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var i=e.headers;i&&Object.keys(i).forEach(function(e){o.setRequestHeader(e,i[e])}),e.responseType&&(o.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){o.abort(),r(new ke)}),e.timeout&&(o.timeout=e.timeout),o.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),o.status>=200&&o.status<300?n(new Ce(o.status,o.statusText,o.response||o.responseText)):r(new Se(o.statusText,o.status))},o.onerror=function(){t.logger.log(ye.Warning,"Error from HTTP request. "+o.status+": "+o.statusText+"."),r(new Se(o.statusText,o.status))},o.ontimeout=function(){t.logger.log(ye.Warning,"Timeout from HTTP request."),r(new xe)},o.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(Pe),_e=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();if("undefined"==typeof XMLHttpRequest){var Oe="function"==typeof __webpack_require__?__non_webpack_require__:require;$e=Oe("./NodeHttpClient")}var Re=function(e){function t(t){var n=e.call(this)||this;if("undefined"!=typeof XMLHttpRequest)n.httpClient=new Ie(t);else{if(void 0===$e)throw new Error("No HttpClient could be created.");n.httpClient=new $e.NodeHttpClient(t)}return n}return _e(t,e),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new ke):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(Pe),Ne=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var n=t.split(e.RecordSeparator);return n.pop(),n},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}(),We=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}(),je=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},Me=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},He=function(){function e(){}return e.isRequired=function(e,t){if(null==e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,n){if(!(e in t))throw new Error("Unknown "+n+" value: "+e+".")},e}();function qe(e,t){var n="";return Ae(e)?(n="Binary data of length "+e.byteLength,t&&(n+=". Content: '"+function(e){var t=new Uint8Array(e),n="";return t.forEach(function(e){n+="0x"+(e<16?"0":"")+e.toString(16)+" "}),n.substr(0,n.length-1)}(e)+"'")):"string"==typeof e&&(n="String data of length "+e.length,t&&(n+=". Content: '"+e+"'")),n}function Ae(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Le(e,t,n,r,o,i,s){return je(this,void 0,void 0,function(){var c,a,u,l,h;return Me(this,function(p){switch(p.label){case 0:return o?[4,o()]:[3,2];case 1:(u=p.sent())&&((c={}).Authorization="Bearer "+u,a=c),p.label=2;case 2:return e.log(ye.Trace,"("+t+" transport) sending data. "+qe(i,s)+"."),l=Ae(i)?"arraybuffer":"text",[4,n.post(r,{content:i,headers:a,responseType:l})];case 3:return h=p.sent(),e.log(ye.Trace,"("+t+" transport) request complete. Response status: "+h.statusCode+"."),[2]}})})}var Ue,Fe=function(){function e(e){this.observers=[],this.cancelCallback=e}return e.prototype.next=function(e){for(var t=0,n=this.observers;t<n.length;t++){n[t].next(e)}},e.prototype.error=function(e){for(var t=0,n=this.observers;t<n.length;t++){var r=n[t];r.error&&r.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var n=t[e];n.complete&&n.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new De(this,e)},e}(),De=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(e){})},e}(),Ge=function(){function e(e){this.minimumLogLevel=e}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case ye.Critical:case ye.Error:console.error("["+(new Date).toISOString()+"] "+ye[e]+": "+t);break;case ye.Warning:console.warn("["+(new Date).toISOString()+"] "+ye[e]+": "+t);break;case ye.Information:console.info("["+(new Date).toISOString()+"] "+ye[e]+": "+t);break;default:console.log("["+(new Date).toISOString()+"] "+ye[e]+": "+t)}},e}(),Be=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return Ne.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var t,n;if(Ae(e)||"undefined"!=typeof Buffer&&e instanceof Buffer){var r=new Uint8Array(e);if(-1===(i=r.indexOf(Ne.RecordSeparatorCode)))throw new Error("Message is incomplete.");var o=i+1;t=String.fromCharCode.apply(null,r.slice(0,o)),n=r.byteLength>o?r.slice(o).buffer:null}else{var i,s=e;if(-1===(i=s.indexOf(Ne.RecordSeparator)))throw new Error("Message is incomplete.");o=i+1;t=s.substring(0,o),n=s.length>o?s.substring(o):null}var c=Ne.parse(t),a=JSON.parse(c[0]);if(a.type)throw new Error("Expected a handshake response from the server.");return[n,a]},e}();!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(Ue||(Ue={}));var Ke,Je=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},Xe=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},ze=3e4,Ye=15e3;!function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected"}(Ke||(Ke={}));var Ve,Qe,Ze=function(){function e(e,t,n){var r=this;He.isRequired(e,"connection"),He.isRequired(t,"logger"),He.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=ze,this.keepAliveIntervalInMilliseconds=Ye,this.logger=t,this.protocol=n,this.connection=e,this.handshakeProtocol=new Be,this.connection.onreceive=function(e){return r.processIncomingData(e)},this.connection.onclose=function(e){return r.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=Ke.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:Ue.Ping})}return e.create=function(t,n,r){return new e(t,n,r)},Object.defineProperty(e.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),e.prototype.start=function(){return Je(this,void 0,void 0,function(){var e,t,n=this;return Xe(this,function(r){switch(r.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(ye.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,t=new Promise(function(e,t){n.handshakeResolver=e,n.handshakeRejecter=t}),[4,this.connection.start(this.protocol.transferFormat)];case 1:return r.sent(),this.logger.log(ye.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return r.sent(),this.logger.log(ye.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 3:return r.sent(),this.connectionState=Ke.Connected,[2]}})})},e.prototype.stop=function(){return this.logger.log(ye.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},e.prototype.stream=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createStreamInvocation(e,n),i=new Fe(function(){var e=t.createCancelInvocation(o.invocationId),n=t.protocol.writeMessage(e);return delete t.callbacks[o.invocationId],t.sendMessage(n)});this.callbacks[o.invocationId]=function(e,t){t?i.error(t):e&&(e.type===Ue.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item))};var s=this.protocol.writeMessage(o);return this.sendMessage(s).catch(function(e){i.error(e),delete t.callbacks[o.invocationId]}),i},e.prototype.sendMessage=function(e){return this.resetKeepAliveInterval(),this.connection.send(e)},e.prototype.send=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.createInvocation(e,t,!0),o=this.protocol.writeMessage(r);return this.sendMessage(o)},e.prototype.invoke=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createInvocation(e,n,!1);return new Promise(function(e,n){t.callbacks[o.invocationId]=function(t,r){r?n(r):t&&(t.type===Ue.Completion?t.error?n(new Error(t.error)):e(t.result):n(new Error("Unexpected message type: "+t.type)))};var r=t.protocol.writeMessage(o);t.sendMessage(r).catch(function(e){n(e),delete t.callbacks[o.invocationId]})})},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var n=this.methods[e];if(n)if(t){var r=n.indexOf(t);-1!==r&&(n.splice(r,1),0===n.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,n=this.protocol.parseMessages(e,this.logger);t<n.length;t++){var r=n[t];switch(r.type){case Ue.Invocation:this.invokeClientMethod(r);break;case Ue.StreamItem:case Ue.Completion:var o=this.callbacks[r.invocationId];null!=o&&(r.type===Ue.Completion&&delete this.callbacks[r.invocationId],o(r));break;case Ue.Ping:break;case Ue.Close:this.logger.log(ye.Information,"Close message received from server."),this.connection.stop(r.error?new Error("Server returned an error on close: "+r.error):void 0);break;default:this.logger.log(ye.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},e.prototype.processHandshakeResponse=function(e){var t,n,r;try{r=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],n=t[1]}catch(e){var o="Error parsing handshake response: "+e;this.logger.log(ye.Error,o);var i=new Error(o);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(n.error){o="Server returned handshake error: "+n.error;throw this.logger.log(ye.Error,o),this.handshakeRejecter(o),this.connection.stop(new Error(o)),new Error(o)}return this.logger.log(ye.Debug,"Server handshake complete."),this.handshakeResolver(),r},e.prototype.resetKeepAliveInterval=function(){var e=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout(function(){return Je(e,void 0,void 0,function(){return Xe(this,function(e){switch(e.label){case 0:if(this.connectionState!==Ke.Connected)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},this.keepAliveIntervalInMilliseconds)},e.prototype.resetTimeoutPeriod=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return e.serverTimeout()},this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,n=this.methods[e.target.toLowerCase()];if(n){if(n.forEach(function(n){return n.apply(t,e.arguments)}),e.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this.logger.log(ye.Error,r),this.connection.stop(new Error(r))}}else this.logger.log(ye.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){var t=this,n=this.callbacks;this.callbacks={},this.connectionState=Ke.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(e),Object.keys(n).forEach(function(t){(0,n[t])(null,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach(function(n){return n.apply(t,[e])})},e.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,n){if(n)return{arguments:t,target:e,type:Ue.Invocation};var r=this.id;return this.id++,{arguments:t,invocationId:r.toString(),target:e,type:Ue.Invocation}},e.prototype.createStreamInvocation=function(e,t){var n=this.id;return this.id++,{arguments:t,invocationId:n.toString(),target:e,type:Ue.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:Ue.CancelInvocation}},e}();!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(Ve||(Ve={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(Qe||(Qe={}));var et=function(){function e(){this.isAborted=!1,this.onabort=null}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}(),tt=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},nt=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},rt=function(){function e(e,t,n,r){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.pollAbort=new et,this.logMessageContent=r,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return tt(this,void 0,void 0,function(){var n,r,o,i;return nt(this,function(s){switch(s.label){case 0:if(He.isRequired(e,"url"),He.isRequired(t,"transferFormat"),He.isIn(t,Qe,"transferFormat"),this.url=e,this.logger.log(ye.Trace,"(LongPolling transport) Connecting."),t===Qe.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},t===Qe.Binary&&(n.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return r=s.sent(),this.updateHeaderToken(n,r),o=e+"&_="+Date.now(),this.logger.log(ye.Trace,"(LongPolling transport) polling: "+o+"."),[4,this.httpClient.get(o,n)];case 2:return 200!==(i=s.sent()).statusCode?(this.logger.log(ye.Error,"(LongPolling transport) Unexpected response code: "+i.statusCode+"."),this.closeError=new Se(i.statusText||"",i.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,n),[2]}})})},e.prototype.getAccessToken=function(){return tt(this,void 0,void 0,function(){return nt(this,function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,null]}})})},e.prototype.updateHeaderToken=function(e,t){e.headers||(e.headers={}),t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t){return tt(this,void 0,void 0,function(){var n,r,o,i;return nt(this,function(s){switch(s.label){case 0:s.trys.push([0,,8,9]),s.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=s.sent(),this.updateHeaderToken(t,n),s.label=3;case 3:return s.trys.push([3,5,,6]),r=e+"&_="+Date.now(),this.logger.log(ye.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,t)];case 4:return 204===(o=s.sent()).statusCode?(this.logger.log(ye.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==o.statusCode?(this.logger.log(ye.Error,"(LongPolling transport) Unexpected response code: "+o.statusCode+"."),this.closeError=new Se(o.statusText||"",o.statusCode),this.running=!1):o.content?(this.logger.log(ye.Trace,"(LongPolling transport) data received. "+qe(o.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(o.content)):this.logger.log(ye.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return i=s.sent(),this.running?i instanceof xe?this.logger.log(ye.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=i,this.running=!1):this.logger.log(ye.Trace,"(LongPolling transport) Poll errored after shutdown: "+i.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(ye.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},e.prototype.send=function(e){return tt(this,void 0,void 0,function(){return nt(this,function(t){return this.running?[2,Le(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return tt(this,void 0,void 0,function(){var e,t;return nt(this,function(n){switch(n.label){case 0:this.logger.log(ye.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),n.label=1;case 1:return n.trys.push([1,,5,6]),[4,this.receiving];case 2:return n.sent(),this.logger.log(ye.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.getAccessToken()];case 3:return t=n.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 4:return n.sent(),this.logger.log(ye.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(ye.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},e.prototype.raiseOnClose=function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError&&(e+=" Error: "+this.closeError),this.logger.log(ye.Trace,e),this.onclose(this.closeError)}},e}(),ot=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},it=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},st=function(){function e(e,t,n,r,o){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.logMessageContent=r,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return ot(this,void 0,void 0,function(){var n,r=this;return it(this,function(o){switch(o.label){case 0:return He.isRequired(e,"url"),He.isRequired(t,"transferFormat"),He.isIn(t,Qe,"transferFormat"),this.logger.log(ye.Trace,"(SSE transport) Connecting."),this.url=e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),o.label=2;case 2:return[2,new Promise(function(n,o){var i=!1;if(t===Qe.Text){var s;if("undefined"!=typeof window)s=new r.eventSourceConstructor(e,{withCredentials:!0});else{var c=r.httpClient.getCookieString(e);s=new r.eventSourceConstructor(e,{withCredentials:!0,headers:{Cookie:c}})}try{s.onmessage=function(e){if(r.onreceive)try{r.logger.log(ye.Trace,"(SSE transport) data received. "+qe(e.data,r.logMessageContent)+"."),r.onreceive(e.data)}catch(e){return void r.close(e)}},s.onerror=function(e){var t=new Error(e.data||"Error occurred");i?r.close(t):o(t)},s.onopen=function(){r.logger.log(ye.Information,"SSE connected to "+r.url),r.eventSource=s,i=!0,n()}}catch(e){return void o(e)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},e.prototype.send=function(e){return ot(this,void 0,void 0,function(){return it(this,function(t){return this.eventSource?[2,Le(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(e))},e}(),ct=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},at=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},ut=function(){function e(e,t,n,r,o){this.logger=n,this.accessTokenFactory=t,this.logMessageContent=r,this.webSocketConstructor=o,this.httpClient=e,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return ct(this,void 0,void 0,function(){var n,r=this;return at(this,function(o){switch(o.label){case 0:return He.isRequired(e,"url"),He.isRequired(t,"transferFormat"),He.isIn(t,Qe,"transferFormat"),this.logger.log(ye.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),o.label=2;case 2:return[2,new Promise(function(n,o){var i;e=e.replace(/^http/,"ws");var s=r.httpClient.getCookieString(e);"undefined"==typeof window&&s&&(i=new r.webSocketConstructor(e,void 0,{headers:{Cookie:""+s}})),i||(i=new r.webSocketConstructor(e)),t===Qe.Binary&&(i.binaryType="arraybuffer"),i.onopen=function(t){r.logger.log(ye.Information,"WebSocket connected to "+e+"."),r.webSocket=i,n()},i.onerror=function(e){var t=null;"undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent&&(t=e.error),o(t)},i.onmessage=function(e){r.logger.log(ye.Trace,"(WebSockets transport) data received. "+qe(e.data,r.logMessageContent)+"."),r.onreceive&&r.onreceive(e.data)},i.onclose=function(e){return r.close(e)}})]}})})},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(ye.Trace,"(WebSockets transport) sending data. "+qe(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},e.prototype.close=function(e){this.logger.log(ye.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!e||!1!==e.wasClean&&1e3===e.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+e.code+" ("+e.reason+").")))},e}(),lt=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},ht=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},pt=null,ft=null;if("undefined"==typeof window&&"undefined"!=typeof require){var gt="function"==typeof __webpack_require__?__non_webpack_require__:require;pt=gt("ws"),ft=gt("eventsource")}var dt=function(){function e(e,t){var n;void 0===t&&(t={}),this.features={},He.isRequired(e,"url"),this.logger=void 0===(n=t.logger)?new Ge(ye.Information):null===n?We.instance:n.log?n:new Ge(n),this.baseUrl=this.resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent||!1;var r="undefined"==typeof window;r||"undefined"==typeof WebSocket||t.WebSocket?r&&!t.WebSocket&&pt&&(t.WebSocket=pt):t.WebSocket=WebSocket,r||"undefined"==typeof EventSource||t.EventSource?r&&!t.EventSource&&void 0!==ft&&(t.EventSource=ft):t.EventSource=EventSource,this.httpClient=t.httpClient||new Re(this.logger),this.connectionState=2,this.options=t,this.onreceive=null,this.onclose=null}return e.prototype.start=function(e){return e=e||Qe.Binary,He.isIn(e,Qe,"transferFormat"),this.logger.log(ye.Debug,"Starting connection with transfer format '"+Qe[e]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(e),this.startPromise)},e.prototype.send=function(e){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(e)},e.prototype.stop=function(e){return lt(this,void 0,void 0,function(){return ht(this,function(t){switch(t.label){case 0:this.connectionState=2,this.stopError=e,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:t.sent(),this.transport=void 0,t.label=6;case 6:return[2]}})})},e.prototype.startInternal=function(e){return lt(this,void 0,void 0,function(){var t,n,r,o,i,s,c,a=this;return ht(this,function(u){switch(u.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,u.label=1;case 1:return u.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==Ve.WebSockets?[3,3]:(this.transport=this.constructTransport(Ve.WebSockets),[4,this.transport.connect(t,e)]):[3,5];case 2:return u.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,r=0,o=function(){var e;return ht(this,function(o){switch(o.label){case 0:return[4,i.getNegotiationResponse(t)];case 1:if(n=o.sent(),2===i.connectionState)return[2,{value:void 0}];if(n.error)throw Error(n.error);if(n.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(t=n.url),n.accessToken&&(e=n.accessToken,i.accessTokenFactory=function(){return e}),r++,[2]}})},i=this,u.label=6;case 6:return[5,o()];case 7:if("object"==typeof(s=u.sent()))return[2,s.value];u.label=8;case 8:if(n.url&&r<100)return[3,6];u.label=9;case 9:if(100===r&&n.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,n,e)];case 10:u.sent(),u.label=11;case 11:return this.transport instanceof rt&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return a.stopConnection(e)},this.changeState(0,1),[3,13];case 12:throw c=u.sent(),this.logger.log(ye.Error,"Failed to start the connection: "+c),this.connectionState=2,this.transport=void 0,c;case 13:return[2]}})})},e.prototype.getNegotiationResponse=function(e){return lt(this,void 0,void 0,function(){var t,n,r,o,i,s;return ht(this,function(c){switch(c.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=c.sent())&&((t={}).Authorization="Bearer "+r,n=t),c.label=2;case 2:o=this.resolveNegotiateUrl(e),this.logger.log(ye.Debug,"Sending negotiation request: "+o+"."),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.httpClient.post(o,{content:"",headers:n})];case 4:if(200!==(i=c.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+i.statusCode);return[2,JSON.parse(i.content)];case 5:throw s=c.sent(),this.logger.log(ye.Error,"Failed to complete negotiation with the server: "+s),s;case 6:return[2]}})})},e.prototype.createConnectUrl=function(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+"id="+t:e},e.prototype.createTransport=function(e,t,n,r){return lt(this,void 0,void 0,function(){var o,i,s,c,a,u,l;return ht(this,function(h){switch(h.label){case 0:return o=this.createConnectUrl(e,n.connectionId),this.isITransport(t)?(this.logger.log(ye.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.transport.connect(o,r)]):[3,2];case 1:return h.sent(),this.changeState(0,1),[2];case 2:i=n.availableTransports||[],s=0,c=i,h.label=3;case 3:return s<c.length?(a=c[s],this.connectionState=0,"number"!=typeof(u=this.resolveTransport(a,t,r))?[3,8]:(this.transport=this.constructTransport(u),n.connectionId?[3,5]:[4,this.getNegotiationResponse(e)])):[3,9];case 4:n=h.sent(),o=this.createConnectUrl(e,n.connectionId),h.label=5;case 5:return h.trys.push([5,7,,8]),[4,this.transport.connect(o,r)];case 6:return h.sent(),this.changeState(0,1),[2];case 7:return l=h.sent(),this.logger.log(ye.Error,"Failed to start the transport '"+Ve[u]+"': "+l),this.connectionState=2,n.connectionId=void 0,[3,8];case 8:return s++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},e.prototype.constructTransport=function(e){switch(e){case Ve.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new ut(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case Ve.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new st(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case Ve.LongPolling:return new rt(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.resolveTransport=function(e,t,n){var r=Ve[e.transport];if(null==r)this.logger.log(ye.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client.");else{var o=e.transferFormats.map(function(e){return Qe[e]});if(function(e,t){return!e||0!=(t&e)}(t,r))if(o.indexOf(n)>=0){if((r!==Ve.WebSockets||this.options.WebSocket)&&(r!==Ve.ServerSentEvents||this.options.EventSource))return this.logger.log(ye.Debug,"Selecting transport '"+Ve[r]+"'."),r;this.logger.log(ye.Debug,"Skipping transport '"+Ve[r]+"' because it is not supported in your environment.'")}else this.logger.log(ye.Debug,"Skipping transport '"+Ve[r]+"' because it does not support the requested transfer format '"+Qe[n]+"'.");else this.logger.log(ye.Debug,"Skipping transport '"+Ve[r]+"' because it was disabled by the client.")}return null},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.changeState=function(e,t){return this.connectionState===e&&(this.connectionState=t,!0)},e.prototype.stopConnection=function(e){this.transport=void 0,(e=this.stopError||e)?this.logger.log(ye.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(ye.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(e)},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(ye.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),n=e.substring(0,-1===t?e.length:t);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===t?"":e.substring(t)},e}();var mt="json",vt=function(){function e(){this.name=mt,this.version=1,this.transferFormat=Qe.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=We.instance);for(var n=[],r=0,o=Ne.parse(e);r<o.length;r++){var i=o[r],s=JSON.parse(i);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case Ue.Invocation:this.isInvocationMessage(s);break;case Ue.StreamItem:this.isStreamItemMessage(s);break;case Ue.Completion:this.isCompletionMessage(s);break;case Ue.Ping:case Ue.Close:break;default:t.log(ye.Information,"Unknown message type '"+s.type+"' ignored.");continue}n.push(s)}return n},e.prototype.writeMessage=function(e){return Ne.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}();const bt=(new(function(){function e(){}return e.prototype.configureLogging=function(e){return He.isRequired(e,"logging"),void 0!==e.log?this.logger=e:this.logger=new Ge(e),this},e.prototype.withUrl=function(e,t){return He.isRequired(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?t:{transport:t},this},e.prototype.withHubProtocol=function(e){return He.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new dt(this.url,e);return Ze.create(t,this.logger||We.instance,this.protocol||new vt)},e}())).withUrl("http://localhost:8888/raceHub").configureLogging(ye.Information).build();window.g_connection=bt;var yt={0:"connecting",1:"connected",2:"reconnecting",4:"disconnected"};let wt,St="",xt="";async function kt(){let e=0;for(;"connected"!==yt[bt.connectionState]&&e<5;)e++,await Pt(5);return bt}0===window.location.hash.indexOf("#race")?(xt=function(){let e=sessionStorage?sessionStorage.getItem("name"):"";return e||(e=prompt("What is your name?"),sessionStorage&&sessionStorage.setItem("name",e)),e}(),wt=new ve({target:document.body,props:{signalrConnection:kt,racingGroup:window.location.hash.split("=")[1],myId:"me"}})):wt=new Z({target:document.body});let Tt=0;async function Ct(){try{await bt.start(),console.log("Successfully connected to hub")}catch(e){console.log(e),console.log("Retrying in 5 seconds"),(Tt+=1)<10&&setTimeout(()=>Ct(),5e3)}}async function Pt(e){return new Promise((t,n)=>{setTimeout(t,1e3*e)})}function $t(e,t){ie.update(n=>(n[e]=t,n))}return bt.onclose(async()=>{await Ct()}),Ct(),bt.on("ReceiveMessage",function(e){console.log(`Received message: ${e}`)}),bt.on("YouAre",e=>{$t(St=e,xt),oe.update(t=>(t[e]={id:e,progress:0,name:xt},t)),wt.myId&&wt.$set({myId:St}),console.log(`YouAre: ${e}`)}),bt.on("UserJoined",(e,t)=>{$t(e,t),oe.update(t=>(t[e]={id:e,progress:0},t)),St&&kt().then(t=>t.invoke("CallUser",e,"ImHere",JSON.stringify({userId:St,username:xt}))),console.log(`User: ${e} joined`)}),bt.on("ImHere",e=>{let{userId:t,username:n}=JSON.parse(e);$t(t,n),oe.update(e=>(e[t]={id:t,progress:0},e)),console.log(`User: ${t} ${n} ${e} says hello`)}),bt.on("UserProgress",(e,t)=>{oe.update(n=>(n[e]={id:e,progress:t},n)),console.log(`User: ${e} joined`)}),bt.on("UserLeft",e=>{oe.update(t=>(t[e]=void 0,t)),console.log(`User: ${e} left`)}),window.g_test2=async function(e){try{await bt.invoke("JoinGroup","test-group")}catch(e){return console.error(e.toString())}},wt}();
//# sourceMappingURL=bundle.js.map
